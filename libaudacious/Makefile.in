include ../mk/rules.mk
include ../mk/objective.mk

beepincludedir = $(includedir)/audacious

OBJECTIVE_LIBS = libaudacious.so
OBJECTIVE_SONAME_SUFFIX = 3.0.0

LDFLAGS += -Wl,-export-dynamic

LIBADD = \
	$(GTK_LIBS)      \
	$(GCONF_LIBS)    \
	$(GNOMEVFS_LIBS)

CFLAGS += -fPIC -DPIC \
	$(GTK_CFLAGS)        \
	$(GCONF_CFLAGS)      \
	$(GNOMEVFS_CFLAGS)   \
	-I..		      \
	-I../intl

CONF_SRC = configdb_$(CONFIGDB_BACKEND).c
VFS_SRC = vfs_$(VFS_BACKEND).c

SOURCES = \
	$(CONF_SRC) \
	rcfile.c \
	$(VFS_SRC) \
	configfile.c \
	beepctrl.c \
	dirbrowser.c \
	util.c \
	formatter.c \
	titlestring.c \
	xentry.c \
	xconvert.c \
	xml_document.c

OBJECTS = ${SOURCES:.c=.o}

HEADERS = \
	vfs.h rcfile.h configdb.h \
	configfile.h \
	beepctrl.h dirbrowser.h util.h \
	formatter.h titlestring.h xml_document.h

install-posthook:
	@mv ${DESTDIR}/${LIBDIR}/libaudacious.so ${DESTDIR}/${LIBDIR}/libaudacious.so.3.0.0
	@ln -sf ${LIBDIR}/libaudacious.so.3.0.0 \
		${DESTDIR}/${LIBDIR}/libaudacious.so.3
	@ln -sf ${LIBDIR}/libaudacious.so.3 \
		${DESTDIR}/${LIBDIR}/libaudacious.so
